# Research Methodology

**深度研究方法论** - 使用 Graph of Thoughts 的完整指南

> 📘 **相关文档**: [CLAUDE.md](CLAUDE.md) | [ARCHITECTURE.md](ARCHITECTURE.md)

---

## 概述

本文档提供使用 Graph of Thoughts (GoT) 框架进行 AI 驱动深度研究的完整方法论。这种方法通过迭代搜索、阅读、分析和综合信息，并包含显式引用，实现自主多步骤研究。

**关键特性**:

- 7 阶段结构化研究流程
- Graph of Thoughts 复杂推理与优化
- 多代理并行部署 (3-8 个代理)
- 严格的引用标准与 A-E 质量评级
- 链式验证防止幻觉
- 使用 Task 代理的自我包含实现

**重要提示**:

- 所有研究输出保存在 `RESEARCH/[topic_name]/` 目录
- 分割大文档避免上下文限制
- 使用 TodoWrite 跟踪任务完成
- 使用 GoT 控制器时维护图状态

---

## Graph of Thoughts 理解

### 基础概念

Graph of Thoughts 是一个推理框架，其中：

- **思想 = 节点**: 每个研究发现或综合是一个具有唯一 ID 的节点
- **边 = 依赖关系**: 连接父思想到子思想
- **转换**: 创建 (Generate)、合并 (Aggregate) 或改进 (Refine) 思想的操作
- **评分**: 每个思想基于引用密度、来源可信度、声明验证、全面性和逻辑连贯性评估 0-10 分
- **剪枝**: 低分分支使用 KeepBestN(n) 操作被放弃
- **前沿**: 可用于扩展的活动节点

系统通过并行探索多个研究路径、评分它们，并通过图遍历找到最优解。

### GoT 转换操作

| 操作 | 目的 | 示例 |
|------|------|------|
| **Generate(k)** | 从父思想创建 k 个新思想 | Generate(3) → 3 个不同的研究角度 |
| **Aggregate(k)** | 将 k 个思想合并为一个更强的思想 | Aggregate(3) → 1 个综合综述 |
| **Refine(1)** | 在不添加新内容的情况下改进思想 | Refine(node_5) → 增强清晰度和深度 |
| **Score** | 评估思想质量 (0-10) | 基于引用、准确性、完整性 |
| **KeepBestN(n)** | 剪枝以保留每层仅前 n 个节点 | KeepBestN(5) → 保留最佳 5 条路径 |

### 图状态结构

```json
{
  "nodes": {
    "n1": {
      "text": "带有引用的研究发现",
      "score": 8.5,
      "type": "root|generated|aggregated|refined",
      "depth": 0,
      "sources": ["url1", "url2"]
    }
  },
  "edges": [
    {"from": "n1", "to": "n2", "operation": "Generate"}
  ],
  "frontier": ["n2", "n3"],
  "budget": {
    "tokens_used": 15000,
    "max_tokens": 50000
  }
}
```

### 图遍历策略

控制器维护图状态并决定应用哪些转换：

1. **早期深度 (0-2)**: 激进的 Generate(3) 探索搜索空间
2. **中期深度 (2-3)**: 为有前景的路径 Generate + 为弱节点 Refine 混合
3. **后期深度 (3-4)**: Aggregate 最佳分支 + 最终 Refine
4. **剪枝**: 每个深度层级仅保留前 5 个节点
5. **终止**: 当最佳节点评分 9+ 或深度超过 4

---

## 7 阶段深度研究流程

### Phase 1: 问题范围界定

**目标**: 将模糊问题转换为结构化研究提示

**活动**:

- 通过结构化对话澄清研究问题
- 定义输出格式和成功标准
- 识别约束、范围边界和所需语气
- 确定目标受众和技术深度
- 创建具有清晰参数的明确查询

**用户交互 - 澄清问题**:

- 具体焦点领域
- 输出格式要求（报告、演示、分析）
- 地理和时间范围
- 目标受众（技术团队、高管、普通）
- 特殊要求（数据、可视化、比较）

**交付物**: 具有清晰目标的结构化研究提示

---

### Phase 2: 检索规划

**目标**: 创建全面的研究执行计划

**活动**:

- 将主问题分解为 3-5 个子主题
- 为每个子主题生成特定搜索查询
- 选择适当的数据源（学术、行业、新闻）
- 规划多代理部署策略（3-8 个代理）
- 使用 GoT 将研究建模为操作图
- 创建用户批准的研究计划

**子主题分解模板**:

1. 当前状态和趋势
2. 关键挑战和限制
3. 未来发展和预测
4. 案例研究和实际应用
5. 专家意见和行业观点

**代理部署规划**:

- 3-5 个 Web 研究代理: 当前信息、趋势、新闻
- 1-2 个学术/技术代理: 论文、规范、方法论
- 1 个交叉引用代理: 事实核查和验证

**交付物**: 用户批准的详细研究计划和代理部署策略

---

### Phase 3: 迭代查询

**目标**: 使用并行代理执行系统性信息收集

**活动**:

- 并行部署 3-8 个专业研究代理
- 跨多个来源系统执行搜索
- 导航和提取相关信息
- 基于发现制定新查询（ReAct 模式）
- 应用 GoT 操作进行复杂推理
- 使用多种搜索模态（WebSearch、WebFetch、Puppeteer）

**工具**:

- **WebSearch**: 查找相关源的一般网络搜索
- **WebFetch**: 从特定 URL 提取和分析内容
- **mcp__puppeteer__**: JavaScript 重型网站的浏览器自动化
- **Task**: 多步操作的自主导代理

**代理类型**:

- **Web 研究代理 (3-5)**: 当前信息、趋势、新闻、真实世界数据
- **学术/技术代理 (1-2)**: 研究论文、技术规范、方法论
- **交叉引用代理 (1)**: 事实核查、验证、交叉验证

**交付物**: 所有代理的原始研究发现，包含来源 URL 和置信度评级

---

### Phase 4: 来源三角验证

**目标**: 验证和交叉引用所有发现

**活动**:

- 跨多个来源比较发现
- 使用交叉引用验证声明（关键声明至少 2+ 个来源）
- 处理不一致和矛盾
- 使用 A-E 评级系统评估来源可信度
- 使用 GoT 评分函数评估信息质量
- 应用链式验证技术

**验证协议**:

1. **仅主来源** - 链接到原始研究，而非二次报告
2. **存档链接** - 对于时间敏感内容，包含 archive.org 链接
3. **多次确认** - 关键声明需要 2+ 个独立来源
4. **冲突数据** - 记录来源何时不同意并解释差异
5. **来源质量评级** - 对每个来源应用 A-E 等级

**交付物**: 带有置信度评级和来源质量评估的验证发现

---

### Phase 5: 知识综合

**目标**: 将发现组合成连贯叙述

**活动**:

- 使用清晰部分逻辑结构化内容
- 使用适当流程编写综合部分
- 为每个事实声明包含内联引用
- 在相关时添加数据可视化
- 使用 GoT Aggregate 操作合并发现
- 应用链式密度进行信息压缩

**综合过程**:

1. 收集所有代理发现
2. 识别重叠和矛盾
3. 使用证据解决冲突
4. 创建统一叙述
5. 维护来自每个代理的来源归属

**链式密度方法**:

1. 第一遍: 提取关键点（低密度）
2. 第二遍: 添加支持细节和上下文
3. 第三遍: 压缩同时保留所有关键信息
4. 最终遍历: 包含所有基本事实和引用的最大密度

**交付物**: 带内联引用的草稿研究报告

---

### Phase 6: 质量保证

**目标**: 确保准确性和完整性

**活动**:

- 检查幻觉和无支持声明
- 验证所有引用匹配内容
- 确保完整性和清晰度
- 应用链式验证技术
- 使用 GoT 真值操作进行验证
- 在最终文档上运行引用验证器

**质量检查清单**:

- [ ] 每个声明都有可验证来源
- [ ] 多个来源证实关键发现
- [ ] 矛盾得到承认和解释
- [ ] 来源是近期和权威的
- [ ] 无幻觉或无支持声明
- [ ] 从证据到结论的清晰逻辑流程
- [ ] 全程适当的引用格式

**交付物**: 质量保证的研究报告

---

### Phase 7: 输出与打包

**目标**: 格式化和交付最终研究

**活动**:

- 格式化以获得最佳可读性
- 创建执行摘要（1-2 页）
- 生成带有来源质量评级的适当参考书目
- 组织到文件夹结构
- 以请求格式导出
- 包含方法和局限性文档

**输出结构**:

```
RESEARCH/[topic_name]/
├── README.md                    # 概述和导航指南
├── executive_summary.md         # 1-2 页关键发现
├── full_report.md               # 完整分析 (20-50 页)
├── data/
│   ├── raw_data.csv
│   ├── processed_data.json
│   └── statistics_summary.md
├── visuals/
│   ├── charts/
│   ├── graphs/
│   └── descriptions.md
├── sources/
│   ├── bibliography.md
│   ├── source_quality_table.md  # A-E 评级
│   └── screenshots/
├── research_notes/
│   ├── agent_1_findings.md
│   ├── agent_2_findings.md
│   └── synthesis_notes.md
└── appendices/
    ├── methodology.md
    ├── limitations.md
    └── future_research.md
```

**交付物**: RESEARCH/[topic_name]/ 目录中的完整研究包

---

## GoT 实现细节

### 核心 GoT 执行

当请求深度研究时，部署维护图状态和编排转换的 GoT 控制器：

#### GoT 执行循环

```typescript
repeat until DONE {
    1. 选择 Ranker R 的前沿思想（评分最高的前 3 个）
    2. 为每个选定的思想，选择转换 T:
       - 如果深度 < 2: Generate(3) 探索分支
       - 如果评分 < 7: Refine(1) 改进质量
       - 如果多个良好路径: Aggregate(k) 合并
    3. 部署转换代理并等待结果
    4. 使用新节点、边和评分更新图
    5. 剪枝: 在每个深度级别 KeepBestN(5)
    6. 当 max_score > 9 或深度 > 4 时退出
}
```

### 转换代理模板

> **注意**: 完整的代理模板已移至 `.claude/agents/` 目录。
> 以下为简化参考 - 实际实现请参考相应的 AGENT.md 文件。

#### Generate 代理

**位置**: `.claude/agents/got-agent/AGENT.md`

**核心职责**:
- 从父思想创建 k 个并行研究路径
- 每个路径探索不同角度
- 返回带有评分的 k 个节点

#### Aggregate 代理

**位置**: `.claude/agents/got-agent/AGENT.md`

**核心职责**:
- 将 k 个思想合并为一个更强的统一思想
- 解决矛盾
- 保留所有引用
- 返回比任何输入都更高质量的 1 个节点

#### Refine 代理

**位置**: `.claude/agents/got-agent/AGENT.md`

**核心职责**:
- 在不添加新主要内容的情况下改进思想
- 使用 WebSearch 进行事实核查
- 增强清晰度和完整性
- 返回改进的思想

---

## 引用要求与来源可追溯性

### 强制性引用标准

**每个事实声明必须包含**:

1. **作者/组织** - 谁做出此声明
2. **日期** - 信息发布时间
3. **来源标题** - 论文、文章或报告名称
4. **URL/DOI** - 直接链接以验证来源
5. **页码** - 对于长文档（如适用）

### 引用格式

**学术论文**:

```
(Author et al., Year, p. XX) 附参考中的完整引用
示例: (Smith et al., 2023, p. 145)
完整: Smith, J., Johnson, K., & Lee, M. (2023). "Title of Paper." Journal Name, 45(3), 140-156. https://doi.org/10.xxxx/xxxxx
```

**网络来源**:

```
(Organization, Year, Section Title)
示例: (NIH, 2024, "Treatment Guidelines")
完整: National Institutes of Health. (2024). "Treatment Guidelines for Metabolic Syndrome." Retrieved [date] from https://www.nih.gov/specific-page
```

**直接引用**:

```
"Exact quote from source" (Author, Year, p. XX)
```

### 来源质量评级

使用此 A-E 等级评估每个来源：

- **A**: 同行评审 RCT、系统综述、荟萃分析
- **B**: 队列研究、病例对照研究、临床指南、reputable 分析师
- **C**: 专家意见、病例报告、机制研究
- **D**: 初步研究、预印本、会议摘要、博客
- **E**: 轶事、理论或推测

### 来源验证协议

1. **仅主来源** - 链接到原始研究，而非二次报告
2. **存档链接** - 对于时间敏感内容，包含 archive.org 链接
3. **多次确认** - 关键声明需要 2+ 个独立来源
4. **冲突数据** - 记录来源何时不同意并解释差异
5. **近期检查** - 相关时优先考虑近 2 年的来源

### 可追溯性要求

**对于医疗/健康信息**:

- 可用时的 PubMed ID (PMID)
- 临床试验注册号
- FDA/监管机构引用
- 指南的版本/更新日期

**对于遗传信息**:

- dbSNP rs 号
- 基因数据库链接（OMIM、GeneCards）
- 群体频率来源（gnomAD、1000 Genomes）
- 带置信区间的效应大小来源

**对于统计声明**:

- 样本大小
- P 值和置信区间
- 使用的统计方法
- 数据可用性声明

### 来源文档结构

每个研究输出必须包括：

1. **内联引用** - 贯穿文本
2. **参考部分** - 末尾的完整参考书目
3. **来源质量表** - 评估每个来源 A-E
4. **验证检查清单** - 确认每个声明有来源
5. **数据可用性** - 可访问原始数据的位置

---

## 高级研究方法

### 链式验证 (CoVe)

为防止幻觉：

1. 生成初始研究发现
2. 为每个声明创建验证问题
3. 搜索证据回答验证问题
4. 基于验证结果修订发现
5. 重复直到所有声明得到验证

### 链式密度 (CoD) 总结

处理来源时，使用迭代细化增加信息密度：

1. 第一遍: 提取关键点（低密度）
2. 第二遍: 添加支持细节和上下文
3. 第三遍: 压缩同时保留所有关键信息
4. 最终遍历: 包含所有基本事实和引用的最大密度

### ReAct 模式（推理 + 行动）

代理应遵循此循环：

1. **推理**: 分析需要什么信息
2. **行动**: 执行搜索或检索操作
3. **观察**: 处理结果
4. **推理**: 确定是否需要更多信息
5. **重复**: 继续直到收集足够证据

### 多代理编排角色

对于复杂主题，部署专业代理：

- **规划器代理**: 将研究分解为子主题
- **搜索代理**: 执行查询和检索来源
- **综合代理**: 合并多个来源的发现
- **批评代理**: 验证声明和检查错误
- **编辑代理**: 润色最终输出

### 人工循环检查点

关键干预点：

1. **规划后**: 批准研究策略
2. **验证期间**: 技术声明的专家审查
3. **最终确定前**: 利益相关者签署
4. **交付后**: 反馈整合

---

## 工具使用策略

### 核心工具

1. **WebSearch**: 查找相关源的内置网络搜索能力
2. **WebFetch**: 从特定 URL 提取和分析内容
3. **Read/Write**: 本地管理研究文档
4. **Task**: 复杂多步操作的自主导代理
5. **TodoWrite**: 跟踪研究进度

> **详细工具架构**: 见 [ARCHITECTURE.md](ARCHITECTURE.md)

### Web 研究策略

- **主要**: 使用 WebSearch 工具进行一般网络搜索
- **次要**: 使用 WebFetch 从特定 URL 提取内容
- **高级**: 对于需要交互或 JavaScript 渲染的站点使用 mcp__puppeteer__
- **注意**: 当 MCP web 获取工具可用时，优先于 WebFetch 使用它们

---

## 缓解策略

### 幻觉预防

- 始终基于来源材料声明
- 对关键声明使用链式验证
- 跨多个来源验证
- 适当时明确陈述不确定性
- 从不做无来源声明 - 不确定时说明"需要来源"

### 覆盖优化

- 使用多样化搜索查询
- 检查多个视角
- 包含近期来源（检查日期）
- 承认限制和空白
- 跨不同来源类型搜索（学术、行业、新闻）

### 引用管理

- 跟踪来源 URL 和访问日期
- 需要时逐字引用相关段落
- 维护来源到声明映射
- 使用一致的引用格式
- 研究进展时创建参考书目

---

## 深度研究关键原则

### 迭代细化

深度研究不是线性的 - 它是一个连续循环：

1. **搜索**: 查找相关信息
2. **阅读**: 提取关键见解
3. **细化**: 基于发现生成新查询
4. **验证**: 跨来源检查声明
5. **综合**: 组合成连贯叙述
6. **重复**: 继续直到全面覆盖

### 为什么这优于手动研究

- **广度**: AI 可在几分钟内处理 20+ 个来源 vs 人类数天
- **深度**: 多步推理揭示非显而易见的联系
- **一致性**: 系统方法确保无空白
- **可追溯性**: 每个声明链接到来源
- **效率**: 处理低级任务，解放人类进行分析
- **并行处理**: 多个代理同时工作

### 状态管理

在整个研究过程中，维护：

- 当前研究问题
- 访问的来源及其质量评分
- 提取的声明和验证状态
- 图状态（对于 GoT 实现）
- 与原始计划对比的进度
- 代理发现和综合笔记

---

## 准备开始

此方法论提供 Graph of Thoughts 深度研究所需的一切：

- **自我包含** - 无需外部文件或依赖
- **自动执行** - 请求研究时立即部署
- **真实 GoT 实现** - 图状态、评分、剪枝和优化
- **使用可用工具** - WebSearch、WebFetch、Task 代理、Puppeteer
- **透明过程** - 保存图状态和执行跟踪
- **严格质量** - 引用验证和验证协议

### 开始深度研究

简单地说：**"深度研究 [你的主题]"**

**系统将**:

1. 如需要询问澄清问题
2. 部署 GoT 控制器管理图
3. 启动转换代理（Generate、Refine、Aggregate）
4. 使用评分探索多个研究路径
5. 带完整引用交付最优研究发现

**无需 Python 设置、无 API 密钥、无外部框架** - 一切使用 Task 代理系统运行以实现适当的 Graph of Thoughts 推理。

---

*快速参考见 [CLAUDE.md](CLAUDE.md)。系统架构细节见 [ARCHITECTURE.md](ARCHITECTURE.md)。*
